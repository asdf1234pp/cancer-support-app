<!DOCTYPE html>
<lang="en">
<head>
  <meta charset="UTF-8">
  <title>SEMICOLON - Demo ver.</title>
  <link rel="stylesheet" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
  <!-- Navigation Bar -->
  <nav>
    <div class="container nav-flex">
      <div class="logo">SEMICOLON</div>
      <ul class="nav-menu">
        <li><a href="#home">Home</a></li>
        <li><a href="#services">Services</a></li>
        <li><a href="#contact">Contact</a></li>
        <li><a href="#" id="login-btn">Login</a></li>
      </ul>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero" id="home">
    <div class="container hero-content">
      <h1>Welcome to SEMICOLON</h1>
      <p>ë‚´ìš© <br>ë‚´ìš©</p>
      <a href="#services" class="cta-btn">Get Started</a>
    </div>
  </section>


  <section id="profile-section" style="display:none;">
    <div class="profile-card">
      <h2><span class="profile-icon">ğŸ‘¤</span> My Profile<br>(Exposed Information)</h2>
      <form id="profile-form">
        <label>
          <span>Name</span>
          <input name="name" placeholder="Your name" required>
        </label>
        <label>
          <span>Cancer Type</span>
          <input name="cancerType" placeholder="ex: Stomach, Breast, ..." required>
        </label>
        <label>
          <span>Contact</span>
          <input name="contact" placeholder="Email or phone" required>
        </label>
        <label>
          <span>Short Bio</span>
          <input name="detail" placeholder="Introduce yourself" required>
        </label>
        <button type="submit">ğŸ’¾ Save</button>
        <div id="profile-msg"></div>
      </form>
    </div>
  </section>


  <!-- Services Section -->
  <section class="services" id="services">
    <div class="container">
      <h2>Our Services</h2>
      <div class="cards">
        <a href="exercise.html" class="card-link">
          <div class="card">
            <div class="card-icon">ğŸ’¡</div>
            <h3>ìš´ë™</h3>
            <p>ì•”í™˜ì ë§ì¶¤ ìš´ë™ íŒ ë° ì •ë³´ ë³´ê¸°</p>
          </div>
        </a>
        <a href="diet.html" class="card-link">
          <div class="card">
            <div class="card-icon">âš¡</div>
            <h3>ì‹ë‹¨</h3>
            <p>ì•” ì¢…ë¥˜ë³„ ì‹ë‹¨ ì¶”ì²œ ë³´ê¸°</p>
          </div>
        </a>
        <a href="#profile-section" class="card-link">
          <div class="card">
            <div class="card-icon">ğŸ¨</div>
            <h3>ì§ì—…(ê°œì¸ìš©)</h3>
            <p>í”„ë¡œí•„ ì •ë³´ ë“±ë¡ ë° ìˆ˜ì •</p>
          </div>
        </a>
        <a href="company.html" class="card-link">
          <div class="card">
            <div class="card-icon">ğŸŒ</div>
            <h3>ê¸°ì—… ì„œë¹„ìŠ¤ ì „í™˜</h3>
            <p>ê¸°ì—…íšŒì› ì „ìš© ë§¤ì¹­ ì„œë¹„ìŠ¤</p>
          </div>
        </a>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section class="contact" id="contact">
    <div class="container">
      <h2>Contact</h2>
      <form class="contact-form">
        <input type="text" placeholder="Your Name" required>
        <input type="email" placeholder="Your Email" required>
        <textarea rows="4" placeholder="Your Message" required></textarea>
        <button type="submit">Send Message</button>
      </form>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container footer-flex">
      <div>Â© 2025 SEMICOLON. All rights reserved.</div>
      <div>
        <a href="#">Instagram</a> | <a href="#">Twitter</a> | <a href="#">GitHub</a>
      </div>
    </div>
  </footer>

<div id="modal-bg" style="display:none;">
  <div class="modal">
    <div class="modal-tabs">
      <button id="show-login" class="active">Login</button>
      <button id="show-register">Sign up</button>
    </div>
    <form id="login-form" style="display:block;">
      <h3>Login</h3>
      <input name="username" placeholder="Username" required>
      <input type="password" name="password" placeholder="Password" required>
      <button type="submit">Login</button>
    </form>
    <form id="register-form" style="display:none;">
      <h3>Sign up</h3>
      <input name="username" placeholder="Username" required>
      <input type="password" name="password" placeholder="Password" required>
      <input name="name" placeholder="Name" required>
      <input name="cancerType" placeholder="Cancer Type" required>
      <input name="contact" placeholder="Contact (Email/Phone)" required>
      <input name="detail" placeholder="Short Bio" required>
      <button type="submit">Sign up</button>
    </form>
    <div id="modal-msg"></div>
    <button id="modal-close" class="modal-close">Ã—</button>
  </div>
</div>

<script>
const modalBg = document.getElementById('modal-bg');
document.getElementById('login-btn').onclick = () => modalBg.style.display = 'block';
document.getElementById('modal-close').onclick = () => modalBg.style.display = 'none';
document.getElementById('show-login').onclick = () => {
  document.getElementById('login-form').style.display = 'block';
  document.getElementById('register-form').style.display = 'none';
  document.getElementById('show-login').classList.add('active');
  document.getElementById('show-register').classList.remove('active');
};
document.getElementById('show-register').onclick = () => {
  document.getElementById('login-form').style.display = 'none';
  document.getElementById('register-form').style.display = 'block';
  document.getElementById('show-register').classList.add('active');
  document.getElementById('show-login').classList.remove('active');
};
document.getElementById('modal-bg').onclick = (e) => {
  if (e.target === modalBg) modalBg.style.display = 'none';
};
// íšŒì›ê°€ì…
document.getElementById('register-form').onsubmit = async (e) => {
  e.preventDefault();
  const data = Object.fromEntries(new FormData(e.target));
  const res = await fetch('/api/register', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify(data)
  });
  const msg = await res.json();
  document.getElementById('modal-msg').innerText = msg.success ? 'Sign up complete!' : 'Error: ' + msg.error;
  
  if (msg.success) {
    setTimeout(() => {
      document.getElementById('modal-bg').style.display = 'none';
      document.getElementById('modal-msg').innerText = '';
      document.getElementById('register-form').reset();
    }, 1500);
  }
};

// ë¡œê·¸ì¸
document.getElementById('login-form').onsubmit = async (e) => {
  e.preventDefault();
  const data = Object.fromEntries(new FormData(e.target));
  const res = await fetch('/api/login', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify(data)
  });
  const msg = await res.json();
  if (msg.success) {
    document.getElementById('modal-msg').innerText = 'Login successful!';
    setTimeout(() => { window.location.reload(); }, 800);
  } else {
    document.getElementById('modal-msg').innerText = 'Error: ' + (msg.error || 'Login failed');
  }
};

let loggedInUsername = null;

// ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ì„¸íŒ…
document.getElementById('login-form').onsubmit = async (e) => {
  e.preventDefault();
  const data = Object.fromEntries(new FormData(e.target));
  const res = await fetch('/api/login', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify(data)
  });
  const msg = await res.json();
  if (msg.success) {
    document.getElementById('modal-msg').innerText = 'Login successful!';
    setTimeout(() => {
      document.getElementById('modal-bg').style.display = 'none';
      document.getElementById('modal-msg').innerText = '';
      loggedInUsername = data.username;
      showProfileSection(loggedInUsername);
    }, 800);
  } else {
    document.getElementById('modal-msg').innerText = 'Error: ' + (msg.error || 'Login failed');
  }
};

// ë‚´ ì •ë³´ í¼ í‘œì‹œ/ê¸°ì¡´ ì •ë³´ ì±„ìš°ê¸°
function showProfileSection(username) {
  document.getElementById('profile-section').style.display = '';
  fetch('/api/me?username=' + encodeURIComponent(username))
    .then(r => r.json())
    .then(user => {
      document.querySelector('#profile-form [name="name"]').value = user.name || '';
      document.querySelector('#profile-form [name="cancerType"]').value = user.cancerType || '';
      document.querySelector('#profile-form [name="contact"]').value = user.contact || '';
      document.querySelector('#profile-form [name="detail"]').value = user.detail || '';
    });
}

// ë‚´ ì •ë³´ ì €ì¥(ìˆ˜ì •/ì €ì¥)
document.getElementById('profile-form').onsubmit = async (e) => {
  e.preventDefault();
  if (!loggedInUsername) {
    document.getElementById('profile-msg').innerText = 'Login first!';
    return;
  }
  const data = Object.fromEntries(new FormData(e.target));
  const res = await fetch('/api/profile', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({
      username: loggedInUsername,
      profile: data
    })
  });
  const msg = await res.json();
  document.getElementById('profile-msg').innerText = msg.success ? 'Saved!' : 'Error: ' + msg.error;
  if (msg.success) setTimeout(() => document.getElementById('profile-msg').innerText = '', 1200);
};

</script>

</body>
</html>
